<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>创建npyscreen应用程序</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="npyscreen.html">npyscreen</a></p>

<ol>
<li><a href="npyscreen--npyscreen介绍.html">npyscreen介绍</a></li>
<li><a href="npyscreen--创建npyscreen应用程序.html">创建npyscreen应用程序</a></li>
<li><a href="npyscreen--Application应用对象.html">Application应用对象</a></li>
<li><a href="npyscreen--Form窗口对象.html">Form窗口对象</a></li>
<li><a href="npyscreen--控件基本特性.html">控件:基本特性</a></li>
<li><a href="npyscreen--控件显示文本.html">控件:显示文本</a></li>
<li><a href="npyscreen--控件选取选项.html">控件:选取选项</a></li>
<li><a href="npyscreen--控件树表与树的显示.html">控件:树表与树的显示</a></li>
<li><a href="npyscreen--控件日期,滑块和复合控件.html">控件:日期,滑块和复合控件</a></li>
<li><a href="npyscreen--控件网格.html">控件:网格</a></li>
<li><a href="npyscreen--控件其他控制.html">控件:其他控制</a></li>
<li><a href="npyscreen--控件标题控件.html">控件:标题控件</a></li>
<li><a href="npyscreen--控件控件框.html">控件:控件框</a></li>
<li><a href="npyscreen--按键绑定全解.html">按键绑定全解</a></li>
<li><a href="npyscreen--增强鼠标支持.html">增强鼠标支持</a></li>
<li><a href="npyscreen--色彩支持.html">色彩支持</a></li>
<li><a href="npyscreen--显示简讯通知及选项.html">显示简讯通知及选项</a></li>
<li><a href="npyscreen--清空屏幕.html">清空屏幕</a></li>
<li><a href="npyscreen--应用支持.html">应用支持</a></li>
<li><a href="npyscreen--编写更复杂的窗口.html">编写更复杂的窗口</a></li>
<li><a href="npyscreen--编写测试.html">编写测试</a></li>
<li><a href="npyscreen--示例程序一个简单的通讯录.html">示例程序:一个简单的通讯录</a></li>
</ol></div>
<div class="page"><h1><b><u>创建npyscreen应用程序</u></b></h1><strong><h2>创建npyscreen应用程序</h2></strong><br /><br /><strong><h3>对象预览</h3></strong><br /><br />npyscreen 应用程序是由3种主要类型的对象构建出来的.<br /><br /><strong>From Objects</strong><br />----窗体对象(通常是整个终端的大小,但有时大一些或者 -用于菜单之类的时候会小一些)是一个可以提供区域容纳其他控件的对象.它们可能会提供一些附加功能,比如处理菜单的系统,或是当用户选择"ok"按钮时的一些例行程序.它们可能也会定义一些在用户按键动作之间,或在窗口上移动的时候,要实施的一些的操作.<br /><br /><strong>Widget Objects</strong><br />----控件对象,这些是窗体上独立的控制部件, -文本框,标签,滚动条等等.<br /><br /><strong>Application Objects</strong><br />----应用对象,这些对象可以给你更方便的方式,来管理你的应用程序的运行过程.虽然有时候也能不使用应用对象来编写一些简单的应用程序,但不建议这样.应用对象,让你在多屏幕应用程序的管理上,按理能更加不容易出错(在那些随时摧毁你的应用的bug上).另外,利用这些对象能让你能使用 npyscreen 开发好的附加特性.<br /><br /><strong><h3>针对非耐心用户的应用程序结构</h3></strong><br /><br />大多数新应用程序看起来都像下面这样:<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br /><span style="color:#0000ff;font-weight:400">#&nbsp;This&nbsp;application&nbsp;class&nbsp;serves&nbsp;as&nbsp;a&nbsp;wrapper&nbsp;for&nbsp;the&nbsp;initialization&nbsp;of&nbsp;curses</span><br /><span style="color:#0000ff;font-weight:400">#&nbsp;and&nbsp;also&nbsp;manages&nbsp;the&nbsp;actual&nbsp;forms&nbsp;of&nbsp;the&nbsp;application</span><br /><br />class&nbsp;MyTestApp(npyscreen.NPSAppManaged):<br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;onStart(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.registerForm(<span style="color:#ff00ff;font-weight:400">"MAIN"</span>,&nbsp;MainForm())<br /><br /><span style="color:#0000ff;font-weight:400">#&nbsp;This&nbsp;form&nbsp;class&nbsp;defines&nbsp;the&nbsp;display&nbsp;that&nbsp;will&nbsp;be&nbsp;presented&nbsp;to&nbsp;the&nbsp;user.</span><br /><br />class&nbsp;MainForm(npyscreen.Form):<br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;create(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name&nbsp;=&nbsp;<span style="color:#ff00ff;font-weight:400">"Text:"</span>,&nbsp;value=&nbsp;<span style="color:#ff00ff;font-weight:400">"Hellow&nbsp;World!"</span>&nbsp;)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;afterEditing(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.parentApp.setNextForm(<span style="color:#ff00ff;font-weight:400">None</span>)<br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;TA&nbsp;=&nbsp;MyTestApp()<br />&nbsp;&nbsp;&nbsp;&nbsp;TA.run()</div></div><br /><br /><strong><h3>应用程序结构细节(教程)</h3></strong><br /><br />第一次使用的用户可能会对上面的代码比较困惑.如果这样,下面的教程就来详细解释一个npyscreen程序的结构.哪怕你很不了解底层的curses系统,你也应该可以跟上我们的节奏.<br /><br /><strong>窗体,控件和应用</strong><br /><br /><strong>使用封装器</strong><br /><br />切换到和切出一个curses环境是一个非常枯燥的任务. python 的 curses 模块提供了完成这些相关工作的封装器.这些在 npyscreen 中以 wrapper_basic 向外暴露.一个简单的应用程序的基本框架看起来应该是这样的:<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />def&nbsp;myFunction(*args):<br />&nbsp;&nbsp;&nbsp;&nbsp;pass<br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;npyscreen.wrapper_basic(myFunction)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;<span style="color:#ff00ff;font-weight:400">"Blink&nbsp;and&nbsp;you&nbsp;missed&nbsp;it!"</span></div></div><br /><br />这么做其实也没什么特别的. curses 环境启动并且啥也没干就退出了.但这只是一个开始.<br /><br />注意,只是完成稍微不同的东西, npyscreen 可能会提供其他不同的封装器.<br /><br /><strong>使用窗体</strong><br /><br />现在我们来放点东西到屏幕上.为此我们需要一个实例:<br /><div class="codebox"><div class="codebox">F&nbsp;=&nbsp;npyscreen.Form(name=<span style="color:#ff00ff;font-weight:400">'My&nbsp;Test&nbsp;Application'</span>)</div></div><br />这个应该就够了,让我们把他放到封装器里面:<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />def&nbsp;myFunction(*args):<br />&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;npyscreen.Form(name=<span style="color:#ff00ff;font-weight:400">'My&nbsp;Test&nbsp;Application'</span>)<br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;npyscreen.wrapper_basic(myFunction)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;<span style="color:#ff00ff;font-weight:400">"Blink&nbsp;and&nbsp;you&nbsp;missed&nbsp;it!"</span></div></div><br />这看起来好像还是啥也没干, -因为我们实际上并没有把窗体显示出来.<br />F.display()会把东西放到屏幕上,但是我们实际上是希望用户能把玩一下,所以让我们使用 F.edit() 来替代它.<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />def&nbsp;myFunction(*args):<br />&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;npyscreen.Form(name=<span style="color:#ff00ff;font-weight:400">'My&nbsp;Test&nbsp;Application'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;F.edit()<br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;npyscreen.wrapper_basic(myFunction)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;<span style="color:#ff00ff;font-weight:400">"Blink&nbsp;and&nbsp;you&nbsp;missed&nbsp;it!"</span></div></div><br /><br />这样没法运行,因为当你想要尝试编辑窗体的时候 npyscreen 会发现没有控件可编辑.我们把它改正一下.<br /><br /><strong><h3>添加第一个控件</h3></strong><br /><br />我们把一个带标题的文本框放上去.用下面的代码来完成<br /><div class="codebox"><div class="codebox">F.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">"First&nbsp;Widget"</span>)</div></div><br />代码的全貌:<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />def&nbsp;myFunction(*args):<br />&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;npyscreen.Form(name=<span style="color:#ff00ff;font-weight:400">'My&nbsp;Test&nbsp;Application'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;F.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">"First&nbsp;Widget"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;F.edit()<br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;npyscreen.wrapper_basic(myFunction)<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;<span style="color:#ff00ff;font-weight:400">"Blink&nbsp;and&nbsp;you&nbsp;missed&nbsp;it!"</span></div></div><br />这就好多了! 这样样我们就有了一个看起来像个应用的东西了.对于用户不管输了什么,只要3点小调整我们就可以改变关闭显示的信息.<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />def&nbsp;myFunction(*args):<br />&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;npyscreen.Form(name=<span style="color:#ff00ff;font-weight:400">'My&nbsp;Test&nbsp;Application'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;myFW&nbsp;=&nbsp;F.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">"First&nbsp;Widget"</span>)&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;&lt;-------&nbsp;Change&nbsp;1</span><br />&nbsp;&nbsp;&nbsp;&nbsp;F.edit()<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;myFW.value&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;&lt;-------&nbsp;Change&nbsp;2</span><br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;npyscreen.wrapper_basic(myFunction)&nbsp;&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;&lt;----&nbsp;and&nbsp;change&nbsp;3</span></div></div><br /><br /><strong><h3>让我们再更加面向对象一点</h3></strong><br /><br />我们一直用的这个方法在简单程序上工作的很好.但一旦我们开始在窗体上创建大量控件,还是把那些代码收进对象里面更好.<br />取代一直用基础的 Form() 类的过程化的方式,让我们来创建一个我们自己的窗口类.我们会覆盖 Form 类的 create() 方法,窗口在创建的时候都会调用它:<br /><div class="codebox"><div class="codebox">class&nbsp;myEmployeeForm(npyscreen.Form):<br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;create(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(myEmployeeForm,&nbsp;<span style="color:#008a8c;font-weight:400">self</span>).create()&nbsp;&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;This&nbsp;line&nbsp;is&nbsp;not&nbsp;strictly&nbsp;necessary:&nbsp;the&nbsp;API&nbsp;promises&nbsp;that&nbsp;the&nbsp;create&nbsp;method&nbsp;does&nbsp;nothing&nbsp;by&nbsp;default.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;I've&nbsp;ommitted&nbsp;it&nbsp;from&nbsp;later&nbsp;example&nbsp;code.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Name'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDepartment&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Department'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleDateCombo,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Date&nbsp;Employed'</span>)</div></div><br />我们使用我们前面的封装代码进行利用:<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />class&nbsp;myEmployeeForm(npyscreen.Form):<br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;create(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Name'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDepartment&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Department'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleDateCombo,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Date&nbsp;Employed'</span>)<br /><br />def&nbsp;myFunction(*args):<br />&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;myEmployeeForm(name&nbsp;=&nbsp;<span style="color:#ff00ff;font-weight:400">"New&nbsp;Employee"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;F.edit()<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span style="color:#ff00ff;font-weight:400">"Created&nbsp;record&nbsp;for&nbsp;"</span>&nbsp;+&nbsp;F.myName.value<br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;npyscreen.wrapper_basic(myFunction)</div></div><br /><br /><strong><h3>给出选择</h3></strong><br /><br />实际上,我们可能不想要任何旧部门的名字也输进来 -我们希望给出一个选项的列表.让我们用一下 TitleSelectOne 控件.这是一个多行控件,我们需要注意,让它只占用屏幕的几行就好(如果让它自己定,它会占用屏幕剩下的所有空间):<br /><div class="codebox"><div class="codebox"><span style="color:#008a8c;font-weight:400">self</span>.myDepartment&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleSelectOne,&nbsp;max_height=<span style="color:#ff00ff;font-weight:400">3</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Department'</span>,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;=&nbsp;[<span style="color:#ff00ff;font-weight:400">'Department&nbsp;1'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;2'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;3'</span>],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scroll_exit&nbsp;=&nbsp;<span style="color:#ff00ff;font-weight:400">True</span>&nbsp;&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;Let&nbsp;the&nbsp;user&nbsp;move&nbsp;out&nbsp;of&nbsp;the&nbsp;widget&nbsp;by&nbsp;pressing&nbsp;the&nbsp;down&nbsp;arrow&nbsp;instead&nbsp;of&nbsp;tab.&nbsp;&nbsp;Try&nbsp;it&nbsp;without</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;to&nbsp;see&nbsp;the&nbsp;difference.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</div></div><br />把这部分放到上下文里:<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />class&nbsp;myEmployeeForm(npyscreen.Form):<br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;create(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Name'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDepartment&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleSelectOne,&nbsp;scroll_exit=<span style="color:#ff00ff;font-weight:400">True</span>,&nbsp;max_height=<span style="color:#ff00ff;font-weight:400">3</span>,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Department'</span>,&nbsp;values&nbsp;=&nbsp;[<span style="color:#ff00ff;font-weight:400">'Department&nbsp;1'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;2'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;3'</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleDateCombo,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Date&nbsp;Employed'</span>)<br /><br />def&nbsp;myFunction(*args):<br />&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;myEmployeeForm(name&nbsp;=&nbsp;<span style="color:#ff00ff;font-weight:400">"New&nbsp;Employee"</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;F.edit()<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span style="color:#ff00ff;font-weight:400">"Created&nbsp;record&nbsp;for&nbsp;"</span>&nbsp;+&nbsp;F.myName.value<br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;npyscreen.wrapper_basic(myFunction)</div></div><br /><br /><strong><h3>进一步面相对象一点</h3></strong><br /><br />到现在我们都做得还不错,但还是比较糙.我们还是手动调用 F.edit() 方法,这对单窗体的应用还过得去,但是以后有递归深度的时候,一不小心就会有问题.这也让一些这个库本身的更巧妙的特性没法来进行操作了.更好的办法是使用 NPSAppManaged 类来管理你的应用程序.<br /><br />让我们废弃这个一直陪这我们的这个旧框架,然后用另一个基础开始的应用程序吧:<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />class&nbsp;MyApplication(npyscreen.NPSAppManaged):<br />&nbsp;&nbsp;&nbsp;&nbsp;pass<br /><br />&nbsp;if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;TestApp&nbsp;=&nbsp;MyApplication().run()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;<span style="color:#ff00ff;font-weight:400">"All&nbsp;objects,&nbsp;baby."</span></div></div><br />这个其实会异常退出,因为你没有 'MAIN' 窗口,这是NPSAppManaged程序的开始点.<br /><br />让我们把它改好,我们会用一下之前的窗口类:<br /><div class="codebox"><div class="codebox">&nbsp;<span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />&nbsp;class&nbsp;myEmployeeForm(npyscreen.Form):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;create(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Name'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDepartment&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleSelectOne,&nbsp;scroll_exit=<span style="color:#ff00ff;font-weight:400">True</span>,&nbsp;max_height=<span style="color:#ff00ff;font-weight:400">3</span>,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Department'</span>,&nbsp;values&nbsp;=&nbsp;[<span style="color:#ff00ff;font-weight:400">'Department&nbsp;1'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;2'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;3'</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleDateCombo,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Date&nbsp;Employed'</span>)<br /><br />class&nbsp;MyApplication(npyscreen.NPSAppManaged):<br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;onStart(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.addForm(<span style="color:#ff00ff;font-weight:400">'MAIN'</span>,&nbsp;myEmployeeForm,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'New&nbsp;Employee'</span>)<br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;&nbsp;TestApp&nbsp;=&nbsp;MyApplication().run()<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">print</span>&nbsp;<span style="color:#ff00ff;font-weight:400">"All&nbsp;objects,&nbsp;baby."</span></div></div><br />如果你运行上面的代码,你可能发现自己有点挫败,因为这个程序会一直显示那个要你编辑的窗口,然后你不得不按下 "^C"(Control C) 来退出.<br /><br />这是因为 NPSAppManaged 类一直会显示任何以它的 NEXT_ACTIVE_FORM 属性(这个例子里的,是默认的'MAIN')命名的窗口.旧版的教程会建议直接去设定它,但是你应该用 setNextForm(formid) 方法.<br /><br />让我们改一下 myEmployeeForm ,告诉它,在 NPSApp 上下文中运行之后,它应该通知它的父对象 NPSAppManaged 停止显示窗口.我们通过创建一个叫做 afterEditing 的特殊方法来实现:<br /><div class="codebox"><div class="codebox">class&nbsp;myEmployeeForm(npyscreen.Form):<br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;afterEditing(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.parentApp.setNextForm(<span style="color:#ff00ff;font-weight:400">None</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;create(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Name'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDepartment&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleSelectOne,&nbsp;scroll_exit=<span style="color:#ff00ff;font-weight:400">True</span>,&nbsp;max_height=<span style="color:#ff00ff;font-weight:400">3</span>,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Department'</span>,&nbsp;values&nbsp;=&nbsp;[<span style="color:#ff00ff;font-weight:400">'Department&nbsp;1'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;2'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;3'</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleDateCombo,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Date&nbsp;Employed'</span>)</div></div><br /><br />如果喜欢的话,我们还可以通过在 MyApplication 类中定义一个特殊的 onlnMainLoop 方法来实现同样的结果,这个方法会在每个窗口被编辑之后调用.<br /><br />我们的代码现在看起来是这样的:<br /><div class="codebox"><div class="codebox"><span style="color:#a020f0;font-weight:400">import</span>&nbsp;npyscreen<br /><br />class&nbsp;myEmployeeForm(npyscreen.Form):<br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;afterEditing(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.parentApp.setNextForm(<span style="color:#ff00ff;font-weight:400">None</span>)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;create(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleText,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Name'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDepartment&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleSelectOne,&nbsp;scroll_exit=<span style="color:#ff00ff;font-weight:400">True</span>,&nbsp;max_height=<span style="color:#ff00ff;font-weight:400">3</span>,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Department'</span>,&nbsp;values&nbsp;=&nbsp;[<span style="color:#ff00ff;font-weight:400">'Department&nbsp;1'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;2'</span>,&nbsp;<span style="color:#ff00ff;font-weight:400">'Department&nbsp;3'</span>])<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.myDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.add(npyscreen.TitleDateCombo,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'Date&nbsp;Employed'</span>)<br /><br />class&nbsp;MyApplication(npyscreen.NPSAppManaged):<br />&nbsp;&nbsp;&nbsp;def&nbsp;onStart(<span style="color:#008a8c;font-weight:400">self</span>):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008a8c;font-weight:400">self</span>.addForm(<span style="color:#ff00ff;font-weight:400">'MAIN'</span>,&nbsp;myEmployeeForm,&nbsp;name=<span style="color:#ff00ff;font-weight:400">'New&nbsp;Employee'</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:400">#&nbsp;A&nbsp;real&nbsp;application&nbsp;might&nbsp;define&nbsp;more&nbsp;forms&nbsp;here.......</span><br /><br />if&nbsp;<span style="color:#008a8c;font-weight:400">__name__</span>&nbsp;==&nbsp;<span style="color:#ff00ff;font-weight:400">'__main__'</span>:<br />&nbsp;&nbsp;&nbsp;TestApp&nbsp;=&nbsp;MyApplication().run()</div></div><br /><br /><strong><h3>方法选择</h3></strong><br /><br />上面最后一个例子,只是写个非常简单的小应用的话可能有点杀伤力过大了.但是这样能提供一个,比我们在教程一开始用的那个,更加健壮的框架来构建更大型的应用程序,也就只多写了几行而已.如果你需要显示不止一个屏幕,或者一直运行一个应用的话,那这就是你该用的处理方法了.<br /></div></div>
</body></html>